# Turn on validation, so we can use import:
version: ~> 1.0

services:
- redis
- postgresql
- yarn

install:
- sudo apt-get install libldap2-dev
- sudo apt-get install libidn11-dev
- wget https://protobuf.googlecode.com/files/protobuf-2.4.1.tar.gz
- tar -xzvf protobuf-2.4.1.tar.gz
- pushd protobuf-2.4.1 && ./configure --prefix=/usr && make && sudo make install && popd

script:
- export RAILS_ENV=test
- bundle install
- rails db:setup
- ./bin/rails assets:precompile
- bundle exec rspec
